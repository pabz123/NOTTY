<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Accountability Dashboard</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="container">

<div class="header">
  <h1>ğŸ“Š Accountability System</h1>
  <div class="header-controls">
    <span id="notificationStatus" style="font-weight:bold;"></span>
    <button id="toggleNotifications" class="toggle-btn" onclick="toggleNotifications()">Pause Notifications</button>
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle Dark Mode">ğŸŒ“</button>
    <button onclick="showStatsModal()">ğŸ“Š Stats</button>
    <button onclick="openTemplatesView()">ğŸ“‹ Templates</button>
    <button onclick="exportData()">ğŸ“¤ Export</button>
    <button onclick="document.getElementById('importFile').click()">ğŸ“¥ Import</button>
    <input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)">
  </div>
</div>

<div class="dashboard">
  <div class="card pending">
    <div>Pending</div>
    <div class="card-value"><span id="pendingCount">0</span></div>
  </div>
  <div class="card missed">
    <div>Missed</div>
    <div class="card-value"><span id="missedCount">0</span></div>
  </div>
  <div class="card completed">
    <div>Completed</div>
    <div class="card-value"><span id="completedCount">0</span></div>
  </div>
</div>

<div id="achievement" style="margin:15px 0;font-size:18px;font-weight:600;"></div>
<div id="streakInfo" style="margin:15px 0;font-size:16px;"></div>

<!-- Filters and Search -->
<div class="filters">
  <input id="searchInput" type="text" placeholder="Search activities..." onkeyup="loadActivities()">
  <select id="statusFilter" onchange="loadActivities()">
    <option value="">All Status</option>
    <option value="pending">Pending</option>
    <option value="missed">Missed</option>
    <option value="completed">Completed</option>
  </select>
  <select id="priorityFilter" onchange="loadActivities()">
    <option value="">All Priority</option>
    <option value="high">High</option>
    <option value="medium">Medium</option>
    <option value="low">Low</option>
  </select>
  <select id="categoryFilter" onchange="loadActivities()">
    <option value="">All Categories</option>
    <option value="general">ğŸ”¹ General</option>
    <option value="work">ğŸ’¼ Work</option>
    <option value="personal">ğŸ‘¤ Personal</option>
    <option value="health">ğŸ’ª Health</option>
    <option value="finance">ğŸ’° Finance</option>
    <option value="education">ğŸ“š Education</option>
    <option value="other">ğŸ“Œ Other</option>
  </select>
  <select id="sortBy" onchange="loadActivities()">
    <option value="deadline">Sort by Deadline</option>
    <option value="priority">Sort by Priority</option>
    <option value="created_at">Sort by Created</option>
  </select>
  <select id="sortOrder" onchange="loadActivities()">
    <option value="asc">Ascending</option>
    <option value="desc">Descending</option>
  </select>
  <button onclick="showCalendarView()" style="margin-left: 10px;">ğŸ“… Calendar View</button>
</div>

<!-- Batch Operations -->
<div style="margin: 15px 0; display: flex; gap: 10px; flex-wrap: wrap;">
  <button onclick="selectAllActivities()">âœ… Select All</button>
  <button onclick="batchCompleteSelected()">âœ“ Complete Selected</button>
  <button onclick="batchDeleteSelected()">ğŸ—‘ï¸ Delete Selected</button>
  <select id="batchCategory">
    <option value="">Change Category...</option>
    <option value="general">ğŸ”¹ General</option>
    <option value="work">ğŸ’¼ Work</option>
    <option value="personal">ğŸ‘¤ Personal</option>
    <option value="health">ğŸ’ª Health</option>
    <option value="finance">ğŸ’° Finance</option>
    <option value="education">ğŸ“š Education</option>
    <option value="other">ğŸ“Œ Other</option>
  </select>
  <button onclick="batchUpdateCategory()">Update Category</button>
</div>

<div class="table-container">
<table>
<thead>
<tr>
  <th><input type="checkbox" id="selectAll" onchange="toggleSelectAll()"></th>
  <th>Title</th>
  <th>Category</th>
  <th>Priority</th>
  <th>Deadline</th>
  <th>Est. Time</th>
  <th>Status</th>
  <th>Actions</th>
</tr>
</thead>
<tbody id="activityTable"></tbody>
</table>

<!-- Pagination Controls -->
<div style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 15px;">
  <button onclick="previousPage()" id="prevBtn">â† Previous</button>
  <span id="pageInfo">Page 1</span>
  <button onclick="nextPage()" id="nextBtn">Next â†’</button>
  <select id="pageSize" onchange="changePageSize()">
    <option value="25">25 per page</option>
    <option value="50" selected>50 per page</option>
    <option value="100">100 per page</option>
  </select>
</div>
</div>

<!-- Edit Modal -->
<div id="overlay" class="overlay" onclick="closeEditForm()"></div>
<div id="editForm" class="edit-form">
  <h3>Edit Activity</h3>
  <input id="editId" type="hidden">
  <input id="editTitle" placeholder="Title">
  <textarea id="editDescription" placeholder="Description" rows="3"></textarea>
  <input id="editDeadline" type="datetime-local">
  <select id="editPriority">
    <option value="low">Low Priority</option>
    <option value="medium">Medium Priority</option>
    <option value="high">High Priority</option>
  </select>
  <select id="editCategory">
    <option value="general">ğŸ”¹ General</option>
    <option value="work">ğŸ’¼ Work</option>
    <option value="personal">ğŸ‘¤ Personal</option>
    <option value="health">ğŸ’ª Health</option>
    <option value="finance">ğŸ’° Finance</option>
    <option value="education">ğŸ“š Education</option>
    <option value="other">ğŸ“Œ Other</option>
  </select>
  <input id="editNotificationMinutes" type="number" placeholder="Notify before (mins)" min="5" max="1440">
  <input id="editEstimatedMinutes" type="number" placeholder="Estimated time (mins)" min="5">
  <div style="display: flex; gap: 10px; margin-top: 15px;">
    <button onclick="saveEdit()">Save</button>
    <button onclick="closeEditForm()">Cancel</button>
  </div>
</div>

<h3>Create Activity</h3>
<div class="form-grid">
  <input id="title" placeholder="Title">
  <input id="description" placeholder="Description">
  <input id="deadline" type="datetime-local">
  <select id="priority">
    <option value="medium">Medium Priority</option>
    <option value="high">High Priority</option>
    <option value="low">Low Priority</option>
  </select>
  <select id="category">
    <option value="general">ğŸ”¹ General</option>
    <option value="work">ğŸ’¼ Work</option>
    <option value="personal">ğŸ‘¤ Personal</option>
    <option value="health">ğŸ’ª Health</option>
    <option value="finance">ğŸ’° Finance</option>
    <option value="education">ğŸ“š Education</option>
    <option value="other">ğŸ“Œ Other</option>
  </select>
  <input id="notificationMinutes" type="number" placeholder="Notify before (mins)" value="30" min="5" max="1440">
  <label><input id="isRecurring" type="checkbox"> Recurring Task</label>
  <select id="recurrencePattern" disabled>
    <option value="">No Recurrence</option>
    <option value="daily">Daily</option>
    <option value="weekly">Weekly</option>
    <option value="monthly">Monthly</option>
  </select>
</div>
<button onclick="createActivity()" style="margin-top: 10px;">Create</button>

<!-- Calendar View Modal -->
<div id="calendarOverlay" class="overlay" onclick="closeCalendarView()" style="display: none;"></div>
<div id="calendarView" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); z-index: 1001; max-width: 90%; max-height: 80vh; overflow-y: auto;">
  <h3>ğŸ“… Calendar View - Upcoming Deadlines</h3>
  <div id="calendarContent"></div>
  <button onclick="closeCalendarView()" style="margin-top: 15px;">Close</button>
</div>

<!-- Activity Notes Modal -->
<div id="notesOverlay" class="overlay" onclick="closeNotesView()" style="display: none;"></div>
<div id="notesView" class="notes-modal">
  <h3>ğŸ“ Activity Notes</h3>
  <input id="currentActivityId" type="hidden">
  <div id="notesList" style="margin: 15px 0; max-height: 300px; overflow-y: auto;"></div>
  <textarea id="newNote" placeholder="Add a note..." rows="3" style="width: 100%; padding: 8px; margin-top: 10px;"></textarea>
  <div style="display: flex; gap: 10px; margin-top: 10px;">
    <button onclick="addNote()">Add Note</button>
    <button onclick="closeNotesView()">Close</button>
  </div>
</div>

<!-- Stats Modal -->
<div id="statsOverlay" class="overlay" onclick="closeStatsModal()" style="display: none;"></div>
<div id="statsModal" class="calendar-modal" style="display: none;">
  <h3>ğŸ“Š Statistics Dashboard</h3>
  <div id="statsContent">
    <div style="margin-bottom: 20px;">
      <h4>ğŸ“ˆ Overall Stats</h4>
      <div class="stat-item">Total Activities: <span id="statsTotalActivities">0</span></div>
      <div class="stat-item">Completed: <span id="statsCompletedActivities">0</span></div>
      <div class="stat-item">Pending: <span id="statsPendingActivities">0</span></div>
      <div class="stat-item">Completion Rate: <span id="statsCompletionRate">0%</span></div>
    </div>
    <div style="margin-bottom: 20px;">
      <h4>ğŸ”¥ Streaks</h4>
      <div class="stat-item">Current Streak: <span id="statsCurrentStreak">0</span> days</div>
      <div class="stat-item">Longest Streak: <span id="statsLongestStreak">0</span> days</div>
    </div>
    <div style="margin-bottom: 20px;">
      <h4>ğŸ“Š Category Breakdown</h4>
      <div id="categoryBreakdown"></div>
    </div>
    <div style="margin-bottom: 20px;">
      <h4>ğŸ¯ Priority Breakdown</h4>
      <div id="priorityBreakdown"></div>
    </div>
    <div>
      <h4>ğŸ† Achievements</h4>
      <div id="achievementsList"></div>
    </div>
  </div>
  <button onclick="closeStatsModal()" style="margin-top: 15px;">Close</button>
</div>

<!-- Subtasks Modal -->
<div id="subtasksOverlay" class="overlay" onclick="closeSubtasksView()" style="display: none;"></div>
<div id="subtasksView" class="notes-modal">
  <h3>âœ… Subtasks</h3>
  <input id="currentSubtaskActivityId" type="hidden">
  <div id="subtasksList" style="margin: 15px 0; max-height: 300px; overflow-y: auto;"></div>
  <input id="newSubtask" placeholder="Add subtask..." style="width: 100%; padding: 8px; margin-top: 10px;">
  <div style="display: flex; gap: 10px; margin-top: 10px;">
    <button onclick="addSubtask()">Add Subtask</button>
    <button onclick="closeSubtasksView()">Close</button>
  </div>
</div>

<!-- Templates Modal -->
<div id="templatesOverlay" class="overlay" onclick="closeTemplatesView()" style="display: none;"></div>
<div id="templatesView" class="notes-modal">
  <h3>ğŸ“‹ Activity Templates</h3>
  <div id="templatesList" style="margin: 15px 0; max-height: 300px; overflow-y: auto;"></div>
  <h4>Create New Template</h4>
  <input id="templateName" placeholder="Template name..." style="width: 100%; padding: 8px; margin-top: 5px;">
  <input id="templateTitle" placeholder="Title template..." style="width: 100%; padding: 8px; margin-top: 5px;">
  <textarea id="templateDescription" placeholder="Description template..." rows="2" style="width: 100%; padding: 8px; margin-top: 5px;"></textarea>
  <div style="display: flex; gap: 10px; margin-top: 10px;">
    <button onclick="createTemplate()">Save Template</button>
    <button onclick="closeTemplatesView()">Close</button>
  </div>
</div>

<!-- History Modal -->
<div id="historyOverlay" class="overlay" onclick="closeHistoryView()" style="display: none;"></div>
<div id="historyView" class="notes-modal">
  <h3>ğŸ“œ Activity History</h3>
  <input id="currentHistoryActivityId" type="hidden">
  <div id="historyList" style="margin: 15px 0; max-height: 400px; overflow-y: auto;"></div>
  <button onclick="closeHistoryView()" style="margin-top: 10px;">Close</button>
</div>

<!-- Attachments Modal -->
<div id="attachmentsOverlay" class="overlay" onclick="closeAttachmentsView()" style="display: none;"></div>
<div id="attachmentsView" class="notes-modal">
  <h3>ğŸ“ Attachments</h3>
  <input id="currentAttachmentActivityId" type="hidden">
  <div id="attachmentsList" style="margin: 15px 0; max-height: 300px; overflow-y: auto;"></div>
  <input type="file" id="attachmentFile" style="margin-top: 10px;">
  <div style="display: flex; gap: 10px; margin-top: 10px;">
    <button onclick="uploadAttachment()">Upload</button>
    <button onclick="closeAttachmentsView()">Close</button>
  </div>
</div>

</div><!-- End container -->

<script src="app.js"></script>
</body>
</html>
